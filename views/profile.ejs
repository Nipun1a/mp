<!DOCTYPE html>
<html>
<head>
    <title>Profile</title>
</head>
<body>
    <h1>Welcome, <%= user.name %>!</h1>

    <!-- Post creation form -->
    <form action="/post" method="POST">
        <textarea name="postcontent" placeholder="Write something..." required></textarea>
        <button type="submit">Post</button>
    </form>

    <h2>Your Posts:</h2>
    <ul>
        <% if (user.posts && user.posts.length > 0) { %>
            <% user.posts.forEach(function(post) { %>
                <li>
                    <strong><%= post.content %></strong>
                    <em>(<%= post.date.toDateString() %>)</em>

                    <!-- Like/Unlike form -->
                    <form action="/like/<%= post._id %>" method="POST" style="display:inline;">
                        <button type="submit">
                            <% if (post.likes.includes(user._id)) { %>
                                Unlike
                            <% } else { %>
                                Like
                            <% } %>
                            (<%= post.likes.length %>)
                        </button>
                    </form>

                    <!-- Edit link -->
                    <a href="/edit/<%= post._id %>">Edit</a>
                </li>
            <% }) %>
        <% } else { %>
            <li>No posts yet.</li>
        <% } %>
    </ul>

    <a href="/logout">Logout</a>
</body>
</html>
